--Mostrar el nombre de la localidad y su número de habitantes para el votante
--con menor edad.

SELECT L.NOMBRE, L.NUMEROHABITANTES
FROM LOCALIDADES L, VOTANTES V
WHERE L.IDLOCALIDAD=V.LOCALIDAD
AND V.FECHANACIMIENTO=(SELECT MAX(FECHANACIMIENTO)
FROM VOTANTES)
;

SELECT MAX(FECHANACIMIENTO)
FROM VOTANTES;

--Mostrar el nombre y la fecha de nacimiento de los votantes andaluces que han
--nacido después de la creación del partido popular. Ordenar el resultado por
--edad (de mayor a menor edad).

SELECT FECHACREACION FROM PARTIDOS WHERE NOMBRECOMPLETO LIKE 'Partido Popular';

SELECT V.NOMBRECOMPLETO, V.FECHANACIMIENTO, P.COMUNIDAD
FROM VOTANTES V, LOCALIDADES L, PROVINCIAS P
WHERE L.PROVINCIA=P.IDPROVINCIA AND V.LOCALIDAD=L.IDLOCALIDAD
ORDER BY COMUNIDAD , FECHANACIMIENTO;

--Solución
SELECT V.NOMBRECOMPLETO, V.FECHANACIMIENTO, P.COMUNIDAD
FROM VOTANTES V, LOCALIDADES L, PROVINCIAS P
WHERE L.PROVINCIA=P.IDPROVINCIA AND V.LOCALIDAD=L.IDLOCALIDAD
AND P.COMUNIDAD='Andalucia'
AND V.FECHANACIMIENTO>(SELECT FECHACREACION FROM PARTIDOS WHERE NOMBRECOMPLETO LIKE 'Partido Popular')
ORDER BY V.FECHANACIMIENTO ASC;

--Mostrar el nombre de las localidades y su comunidad autónoma para aquellas
--localidades que tienen un número de habitantes mayor que la localidad del
--votante que es el segundo votante de más edad de entre todos los votantes
--existentes en la base de datos. Ordenar el resultado alfabéticamente por
--nombre de localidad.

SELECT  L.NOMBRE, P.COMUNIDAD
FROM LOCALIDADES L, PROVINCIAS P, VOTANTES V
WHERE L.PROVINCIA=P.IDPROVINCIA AND V.LOCALIDAD=L.IDLOCALIDAD;


--localidad del votante que es el segundo votante de más edad de entre todos los votantes
--existentes en la base de datos



SELECT MIN(FECHANACIMIENTO)FROM VOTANTES;

SELECT FECHANACIMIENTO AS FECHA, LOCALIDAD AS LOCALIDAD
FROM VOTANTES V, LOCALIDADES L , PROVINCIAS P
WHERE FECHANACIMIENTO >(SELECT MIN(FECHANACIMIENTO) AS FECHA FROM VOTANTES) AND L.PROVINCIA=P.IDPROVINCIA AND V.LOCALIDAD=L.IDLOCALIDAD
ORDER BY FECHANACIMIENTO ASC;

SELECT MIN(FECHA)
FROM (SELECT FECHANACIMIENTO AS FECHA, LOCALIDAD AS LOCALIDAD
FROM VOTANTES V, LOCALIDADES L , PROVINCIAS P
WHERE FECHANACIMIENTO >(SELECT MIN(FECHANACIMIENTO) AS  FROM VOTANTES) AND L.PROVINCIA=P.IDPROVINCIA AND V.LOCALIDAD=L.IDLOCALIDAD
ORDER BY FECHANACIMIENTO ASC);

SELECT LOCALIDAD
FROM (SELECT FECHANACIMIENTO AS FECHA, LOCALIDAD AS LOCALIDAD
      FROM VOTANTES V, LOCALIDADES L , PROVINCIAS P
      WHERE FECHANACIMIENTO >(SELECT MIN(FECHANACIMIENTO) AS FECHA FROM VOTANTES) AND L.PROVINCIA=P.IDPROVINCIA AND V.LOCALIDAD=L.IDLOCALIDAD
                            ORDER BY FECHANACIMIENTO ASC)
                            WHERE FECHA=(SELECT MIN(FECHA)
                            FROM (SELECT FECHANACIMIENTO AS FECHA, LOCALIDAD AS LOCALIDAD
                            FROM VOTANTES V, LOCALIDADES L , PROVINCIAS P
                            WHERE FECHANACIMIENTO >(SELECT MIN(FECHANACIMIENTO) AS  FROM VOTANTES) AND L.PROVINCIA=P.IDPROVINCIA AND V.LOCALIDAD=L.IDLOCALIDAD
                            ORDER BY FECHANACIMIENTO ASC));








